#!/usr/bin/env bash
set -euo pipefail

echo "> audit"

echo "> audit > cargo audit"
# Use cargo-installed version if available, otherwise fall back to system version
SCRIPT_DIR="$(cd "$(dirname "${BASH_SOURCE[0]}")" && pwd)"
PROJECT_ROOT="$(cd "$SCRIPT_DIR/../../.." && pwd)"
CARGO_AUDIT="$PROJECT_ROOT/.devenv/state/cargo-install/bin/cargo-audit"
if [ ! -f "$CARGO_AUDIT" ]; then
  CARGO_AUDIT="cargo-audit"
fi

"$CARGO_AUDIT" audit \
  --ignore RUSTSEC-2023-0071 \
  --ignore RUSTSEC-2024-0436

